# Программа шифрования/дешифрования данных

Программа позволяет шифровать и дешифровать данные с использованием асимметричных RSA-ключей. Реализованы как CLI, так и GUI интерфейсы.

## Особенности

- Использует гибридный метод шифрования: RSA для шифрования симметричного ключа и AES для шифрования данных
- Поддержка шифрования/дешифрования как файлов, так и текстовых сообщений
- Поддержка IV (инициализационного вектора) для обеспечения безопасности
- Два режима работы: CLI и GUI

## Зависимости

- Python 3.6+
- Библиотека `cryptography`

Установить зависимости можно командой:

```bash
pip install cryptography
```

## CLI версия

### Использование

```bash
python enc.py [опции]
```

### Опции

- `-d` - режим дешифрования (без флага - режим шифрования)
- `-i <путь_к_ключу>` - путь к приватному/публичному ключу (в зависимости от режима)
- `-in <путь_к_файлу>` - входной файл для шифрования/дешифрования
- `-out <путь_к_файлу>` - выходной файл для сохранения результата
- `-m "<сообщение>"` - текстовое сообщение для шифрования/дешифрования (вывод в stdout если нет -out)
- `-g` - генерация новой пары ключей

### Примеры

Шифрование файла:
```bash
python enc.py -i pub_key.pem -in document.txt -out encrypted.bin
```

Дешифрование файла:
```bash
python enc.py -d -i priv_key.pem -in encrypted.bin -out decrypted.txt
```

Шифрование сообщения:
```bash
python enc.py -i pub_key.pem -m "Hello, World!" -out encrypted_msg.bin
```

Дешифрование сообщения:
```bash
python enc.py -d -i priv_key.pem -in encrypted_msg.bin
```

Генерация ключей:
```bash
python enc.py -g
```

## GUI версия

Запуск GUI версии:
```bash
python enc_gui.py
```

GUI включает две вкладки: "Шифрование" и "Дешифрование".

### Вкладка "Шифрование"

- Выбор публичного ключа из директории `pubkeys`
- Текстовое поле для ввода сообщений
- Кнопка выбора файла
- Кнопка "Зашифровать"
- Кнопка "Сгенерировать ключи"

### Вкладка "Дешифрование"

- Выбор приватного ключа из директории `privatekeys`
- Текстовое поле для ввода зашифрованных сообщений
- Кнопка выбора файла
- Кнопка "Дешифровать"

## Структура проекта

- `enc.py` - CLI версия программы
- `enc_gui.py` - GUI версия программы
- `privatekeys/` - директория для хранения приватных ключей
- `pubkeys/` - директория для хранения публичных ключей

## Алгоритм шифрования

Программа использует гибридный метод шифрования:

1. Генерируется случайный симметричный ключ (AES-256)
2. Генерируется случайный IV (инициализационный вектор)
3. Данные шифруются с помощью AES в режиме CBC с использованием симметричного ключа и IV
4. Симметричный ключ шифруется с помощью RSA-ключа (публичного для шифрования, приватного для дешифрования)
5. Результатом является комбинация: зашифрованный симметричный ключ + IV + зашифрованные данные

При дешифровании процесс происходит в обратном порядке.